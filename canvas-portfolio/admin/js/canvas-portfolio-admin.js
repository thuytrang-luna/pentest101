( function( $ ) {
	'use strict';

	$( function() {

		/* Set all variables to be used in scope */
		var cnvsportVideoMediaFrame;

		/* Add Video Link */
		$( document ).on( 'click', '.local-video-container .upload-video-link', function( event ) {

			event.preventDefault();

			var parentContainer = $( this ).parents( '.local-video-container' );

			// Options.
			var options = {
				title: cnvsportVideo.title,
				button: {
					text: cnvsportVideo.button,
				},
				library: {
					type: parentContainer.data( 'type' )
				},
				multiple: false
			};

			cnvsportVideoMediaFrame = wp.media( options );

			// When an video is selected in the media frame...
			cnvsportVideoMediaFrame.on( 'select', function() {

				// Get media attachment details from the frame state.
				var attachment = cnvsportVideoMediaFrame.state().get( 'selection' ).first().toJSON();

				parentContainer.find( 'input[name="cnvsport_post_video_url"]' ).val( attachment.url ).change();

				cnvsportVideoMediaFrame.close();
			} );

			cnvsportVideoMediaFrame.open();
		} );

	} );

} )( jQuery );
